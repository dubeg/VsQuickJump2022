<platform:DialogWindow 
    x:Class="QuickJump2022.Forms.SearchForm"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:localb="clr-namespace:QuickJump2022.Behaviors"
    xmlns:localm="clr-namespace:QuickJump2022.Models"
    xmlns:localc="clr-namespace:QuickJump2022.Controls"
    xmlns:localtxt="clr-namespace:QuickJump2022.TextEditor"
    xmlns:platform="clr-namespace:Microsoft.VisualStudio.PlatformUI;assembly=Microsoft.VisualStudio.Shell.15.0"
    xmlns:shell="clr-namespace:Microsoft.VisualStudio.Shell;assembly=Microsoft.VisualStudio.Shell.15.0"
    xmlns:toolkit="clr-namespace:Community.VisualStudio.Toolkit;assembly=Community.VisualStudio.Toolkit"
    xmlns:imaging="clr-namespace:Microsoft.VisualStudio.Imaging;assembly=Microsoft.VisualStudio.Imaging"
    xmlns:imagecatalog="clr-namespace:Microsoft.VisualStudio.Imaging;assembly=Microsoft.VisualStudio.ImageCatalog"
    xmlns:theming="clr-namespace:Microsoft.VisualStudio.PlatformUI;assembly=Microsoft.VisualStudio.Imaging"
    xmlns:utilities="clr-namespace:Microsoft.VisualStudio.PlatformUI;assembly=Microsoft.VisualStudio.Utilities"
    x:Name="dialogWnd"
    mc:Ignorable="d"
    Title="QuickJump Search" 
    BorderThickness="1"
    BorderBrush="{DynamicResource {x:Static platform:EnvironmentColors.MainWindowActiveBuildingBorderBrushKey }}"
    WindowStyle="None"
    Background="Transparent"
    ShowInTaskbar="False"
    ResizeMode="NoResize"
    SizeToContent="Height"
    toolkit:Themes.UseVsTheme="True"
    HasDialogFrame="False"
    theming:ImageThemingUtilities.ImageBackgroundColor="{DynamicResource {x:Static platform:ThemedDialogColors.WindowPanelColorKey}}"
    RenderOptions.BitmapScalingMode="HighQuality"
    RenderOptions.ClearTypeHint="Auto"
    TextOptions.TextFormattingMode="Ideal"
    TextOptions.TextHintingMode="Auto"
    TextOptions.TextRenderingMode="Auto"
    DataContext="{Binding RelativeSource={RelativeSource Self}}"
    >
    <!--
    Any of these brushes could do well as the window's border brush:
    * MainWindowActiveBuildingBorderBrushKey
    * MainWindowActiveDebuggingBorderBrushKey
    * MainWindowActiveDefaultBorderBrushKey
    * AccentBorderBrushKey
    -->
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Search Input (using experimental InputTextEditor) -->
        <localtxt:InputTextEditor 
            x:Name="txtSearch" 
            Grid.Row="0" 
            Margin="0" 
            MinHeight="20" 
            />

        <!-- Items ListBox -->
        <ListBox 
            x:Name="lstItems" 
            Grid.Row="1"
            localb:ListViewBehaviors.MaxVisibleItems="{Binding PageSize}"
            BorderThickness="0"
            BorderBrush="Transparent"
            ScrollViewer.HorizontalScrollBarVisibility="Disabled"
            ScrollViewer.VerticalScrollBarVisibility="Auto"
            ScrollViewer.IsDeferredScrollingEnabled="False"
            ScrollViewer.CanContentScroll="True"
            VirtualizingStackPanel.IsVirtualizing="True"
            VirtualizingStackPanel.VirtualizationMode="Recycling"
            VirtualizingStackPanel.ScrollUnit="Item"
            VirtualizingStackPanel.CacheLength="10,10"
            VirtualizingStackPanel.CacheLengthUnit="Item"
            >
            <ListBox.ItemsPanel>
                <ItemsPanelTemplate>
                    <VirtualizingStackPanel />
                </ItemsPanelTemplate>
            </ListBox.ItemsPanel>
            <ListBox.ItemContainerStyle>
                <Style TargetType="ListBoxItem">
                    <Setter Property="Height" Value="24"/>
                    <Setter Property="BorderThickness" Value="0"/>
                    <Setter Property="BorderBrush" Value="Transparent"/>
                    <Setter Property="Padding" Value="0,2"/>
                    <Setter Property="Margin" Value="0"/>
                    <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                    <Setter Property="IsSelected" Value="{Binding IsSelected}"/>
                </Style>
            </ListBox.ItemContainerStyle>
            <ListBox.ItemTemplate>
                <DataTemplate DataType="{x:Type localm:ListItemViewModel}">
                    <localc:ListItemVisual 
                        FontFamily="{Binding ElementName=dialogWnd, Path=FontFamily}"
                        FontSize="{Binding ElementName=dialogWnd, Path=FontSize}"
                        HintFontSize="{Binding ElementName=dialogWnd, Path=HintFontSize}"
                        />
                </DataTemplate>
            </ListBox.ItemTemplate>
        </ListBox>
    </Grid>
</platform:DialogWindow>
